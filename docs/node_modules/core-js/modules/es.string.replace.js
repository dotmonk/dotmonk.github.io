import fixRegExpWellKnownSymbolLogic from'../internals/fix-regexp-well-known-symbol-logic.js';import fails from'../internals/fails.js';import anObject from'../internals/an-object.js';import toLength from'../internals/to-length.js';import toInteger from'../internals/to-integer.js';import requireObjectCoercible from'../internals/require-object-coercible.js';import advanceStringIndex from'../internals/advance-string-index.js';import getSubstitution from'../internals/get-substitution.js';import regExpExec from'../internals/regexp-exec-abstract.js';import wellKnownSymbol from'../internals/well-known-symbol.js';var REPLACE=wellKnownSymbol("replace"),max=Math.max,min=Math.min,maybeToString=function maybeToString(it){return it===void 0?it:String(it)},REPLACE_KEEPS_$0=function(){return "$0"==="a".replace(/./,"$0")}(),REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=function(){return !!/./[REPLACE]&&""===/./[REPLACE]("a","$0")}(),REPLACE_SUPPORTS_NAMED_GROUPS=!fails(function(){var re=/./;return re.exec=function(){var result=[];return result.groups={a:"7"},result},"7"!=="".replace(re,"$<a>")});fixRegExpWellKnownSymbolLogic("replace",function(_,nativeReplace,maybeCallNative){var UNSAFE_SUBSTITUTE=REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE?"$":"$0";return [function replace(searchValue,replaceValue){var O=requireObjectCoercible(this),replacer=searchValue==null?void 0:searchValue[REPLACE];return replacer===void 0?nativeReplace.call(String(O),searchValue,replaceValue):replacer.call(searchValue,O,replaceValue)},function(string,replaceValue){if("string"==typeof replaceValue&&-1===replaceValue.indexOf(UNSAFE_SUBSTITUTE)&&-1===replaceValue.indexOf("$<")){var res=maybeCallNative(nativeReplace,this,string,replaceValue);if(res.done)return res.value}var rx=anObject(this),S=String(string),functionalReplace="function"==typeof replaceValue;functionalReplace||(replaceValue=String(replaceValue));var global=rx.global;if(global){var fullUnicode=rx.unicode;rx.lastIndex=0;}for(var result,results=[];(result=regExpExec(rx,S),null!==result)&&!(results.push(result),!global);){var matchStr=String(result[0]);""===matchStr&&(rx.lastIndex=advanceStringIndex(S,toLength(rx.lastIndex),fullUnicode));}for(var accumulatedResult="",nextSourcePosition=0,i=0;i<results.length;i++){result=results[i];for(var matched=String(result[0]),position=max(min(toInteger(result.index),S.length),0),captures=[],j=1;j<result.length;j++)captures.push(maybeToString(result[j]));var namedCaptures=result.groups;if(functionalReplace){var replacerArgs=[matched].concat(captures,position,S);namedCaptures!==void 0&&replacerArgs.push(namedCaptures);var replacement=String(replaceValue.apply(void 0,replacerArgs));}else replacement=getSubstitution(matched,S,position,captures,namedCaptures,replaceValue);position>=nextSourcePosition&&(accumulatedResult+=S.slice(nextSourcePosition,position)+replacement,nextSourcePosition=position+matched.length);}return accumulatedResult+S.slice(nextSourcePosition)}]},!REPLACE_SUPPORTS_NAMED_GROUPS||!REPLACE_KEEPS_$0||REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);